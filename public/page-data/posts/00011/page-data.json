{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/00011","result":{"data":{"markdownRemark":{"id":"15ddbe3a-45b8-517f-98fa-1e69d3bee405","html":"<h2 id=\"導入\" style=\"position:relative;\"><a href=\"#%E5%B0%8E%E5%85%A5\" aria-label=\"導入 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>導入</h2>\n<p>本記事では、Azure AD B2Cのユーザーフローを使い、Googleアカウントでの認証処理を開発していきます。</p>\n<p>手順は<a href=\"https://docs.microsoft.com/ja-jp/azure/active-directory-b2c/identity-provider-google\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">公式ドキュメント</a>に準じて行なっていきます。</p>\n<h2 id=\"目次\" style=\"position:relative;\"><a href=\"#%E7%9B%AE%E6%AC%A1\" aria-label=\"目次 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>目次</h2>\n<ol>\n<li>事前準備</li>\n<li>\n<p>Googleアプリの作成</p>\n<ol>\n<li>Google Developers Consoleへのアクセス</li>\n<li>プロジェクトの作成</li>\n<li>承認済みドメインの設定</li>\n<li>認証情報の設定</li>\n</ol>\n</li>\n<li>IDプロバイダーの追加</li>\n<li>ユーザーフローを更新</li>\n<li>ユーザーフローを実行</li>\n</ol>\n<h2 id=\"事前準備\" style=\"position:relative;\"><a href=\"#%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99\" aria-label=\"事前準備 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>事前準備</h2>\n<p>AzureADB2Cのテナントが作成されている必要があります。<br>\nテナントの作成方法については<a href=\"/posts/00008\">こちら</a>を参照してください。  </p>\n<h2 id=\"googleアプリの作成\" style=\"position:relative;\"><a href=\"#google%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E4%BD%9C%E6%88%90\" aria-label=\"googleアプリの作成 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Googleアプリの作成</h2>\n<h3 id=\"google-developers-consoleへのアクセス\" style=\"position:relative;\"><a href=\"#google-developers-console%E3%81%B8%E3%81%AE%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9\" aria-label=\"google developers consoleへのアクセス permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google Developers Consoleへのアクセス</h3>\n<p><a href=\"https://console.developers.google.com/?pli=1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Google Developers Console</a>にアクセスします。<br>\nChromeがログイン済みであれば、ログイン不要で表示されるはずです。<br>\n未ログインであればログインしましょう。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.09.07.png\" alt=\"ScreenShot 2020-09-13 21.09.07.png\"></p>\n<h3 id=\"プロジェクトの作成\" style=\"position:relative;\"><a href=\"#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90\" aria-label=\"プロジェクトの作成 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>プロジェクトの作成</h3>\n<p>ページの左上隅にあるプロジェクトの一覧、もしくは現在のプロジェクト名を選択し、 [新しいプロジェクト] を選択します。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.09.16.png\" alt=\"ScreenShot 2020-09-13 21.09.16.png\"></p>\n<p>[プロジェクト名] を入力し、 [作成] を選択します。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.14.06.png\" alt=\"ScreenShot 2020-09-13 21.14.06.png\"></p>\n<p>プロジェクトが作成されると以下のような画面となります。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.14.20.png\" alt=\"ScreenShot 2020-09-13 21.14.20.png\"></p>\n<h3 id=\"承認済みドメインの設定\" style=\"position:relative;\"><a href=\"#%E6%89%BF%E8%AA%8D%E6%B8%88%E3%81%BF%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-label=\"承認済みドメインの設定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>承認済みドメインの設定</h3>\n<p>左側にあるメニューで [OAuth 同意画面] を選択し、 [外部] を選択し、 [作成] を選択します。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.26.17.png\" alt=\"ScreenShot 2020-09-13 21.26.17.png\"></p>\n<p>アプリケーションの [名前] 、 [承認済みドメイン] セクションに「b2clogin.com」と入力し、[保存] を選択します。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.26.22.png\" alt=\"ScreenShot 2020-09-13 21.26.22.png\"></p>\n<p><img src=\"../media/00011/ScreenShot%202020-09-13%2021.56.34.png\" alt=\"ScreenShot 2020-09-13 21.56.34.png\"></p>\n<h3 id=\"認証情報の設定\" style=\"position:relative;\"><a href=\"#%E8%AA%8D%E8%A8%BC%E6%83%85%E5%A0%B1%E3%81%AE%E8%A8%AD%E5%AE%9A\" aria-label=\"認証情報の設定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>認証情報の設定</h3>\n<p>左側のメニューで [認証情報] を選択して、 [認証情報を作成] > [Oauth client ID (Oauth クライアント ID)] を選択します。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.32.42.png\" alt=\"ScreenShot 2020-09-13 21.32.42.png\">\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.32.52.png\" alt=\"ScreenShot 2020-09-13 21.32.52.png\"></p>\n<ul>\n<li>[アプリケーションの種類] で [Web アプリケーション] を選択</li>\n<li>アプリケーションの名前は任意に設定</li>\n<li>[承認済みの JavaScript 生成元] に以下のように入力</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">https://<span class=\"token punctuation\">{</span>自身のテナント名<span class=\"token punctuation\">}</span>.b2clogin.com</code></pre></div>\n<ul>\n<li>[承認済みのリダイレクト URI] に以下のように入力</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">https://<span class=\"token punctuation\">{</span>自身のテナント名<span class=\"token punctuation\">}</span>.b2clogin.com/<span class=\"token punctuation\">{</span>自身のテナント名<span class=\"token punctuation\">}</span>.onmicrosoft.com/oauth2/authresp</code></pre></div>\n<p>上記のように入力し、作成を押下します。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.34.16.png\" alt=\"ScreenShot 2020-09-13 21.34.16.png\">\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.34.33.png\" alt=\"ScreenShot 2020-09-13 21.34.33.png\"></p>\n<p>作成されるとクライアントIDとクライアントシークレットが表示されます。<br>\nこれをコピーしておきます。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.34.43.png\" alt=\"ScreenShot 2020-09-13 21.34.43.png\"></p>\n<p>作成後は下記のような表示となります。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2021.35.03.png\" alt=\"ScreenShot 2020-09-13 21.35.03.png\"></p>\n<h2 id=\"idプロバイダーの追加\" style=\"position:relative;\"><a href=\"#id%E3%83%97%E3%83%AD%E3%83%90%E3%82%A4%E3%83%80%E3%83%BC%E3%81%AE%E8%BF%BD%E5%8A%A0\" aria-label=\"idプロバイダーの追加 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IDプロバイダーの追加</h2>\n<p>続いてAzureADB2CにGoogleをIDプロバイダーとして登録します。<br>\n左のナビゲーション部分からIDプロバイダーを選択します。<br>\nその中のGoogleを選択します。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.12.09.png\" alt=\"ScreenShot 2020-09-13 22.12.09.png\"></p>\n<p>以下内容で設定します。  </p>\n<ul>\n<li>名前：Google</li>\n<li>クライアントID：※Google側でコピーしたクライアントID</li>\n<li>クライアントシークレット：※Google側でコピーしたクライアントシークレット\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.12.24.png\" alt=\"ScreenShot 2020-09-13 22.12.24.png\"></li>\n</ul>\n<p>登録が完了すると構成にGoogleと追加されます。\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.13.08.png\" alt=\"ScreenShot 2020-09-13 22.13.08.png\"></p>\n<h2 id=\"ユーザーフローを更新\" style=\"position:relative;\"><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E6%9B%B4%E6%96%B0\" aria-label=\"ユーザーフローを更新 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ユーザーフローを更新</h2>\n<p>続いて、Googleをユーザーフローで利用するIDプロバイダーとして追加します。<br>\n使用するユーザーフローのIDプロバイダー設定を開き、Googleにチェックを入れ、「保存」を押下します。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.16.21.png\" alt=\"ScreenShot 2020-09-13 22.16.21.png\"></p>\n<h2 id=\"ユーザーフローを実行\" style=\"position:relative;\"><a href=\"#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E5%AE%9F%E8%A1%8C\" aria-label=\"ユーザーフローを実行 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ユーザーフローを実行</h2>\n<p>ではユーザーフローを実行していきましょう。<br>\n実行すると以下のようにGoogleログインが追加されていることがわかります。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.16.45.png\" alt=\"ScreenShot 2020-09-13 22.16.45.png\"></p>\n<p>Googleボタンを押下すると、Google側の画面に遷移します。<br>\n先ほどGoogle側に追加したアプリの同意画面が表示されます。<br>\n「ログイン」を押下します。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.16.55.png\" alt=\"ScreenShot 2020-09-13 22.16.55.png\"></p>\n<p>ログインが成功すると、リダイレクトURL先に遷移します。<br>\n以下のキャプチャは<code class=\"language-text\">https://jwt.ms/</code>をリダイレクトURLに設定した場合です。<br>\nIDトークンのidpに<code class=\"language-text\">google.com</code>が設定されており、Googleログインが成功しているのがわかります。<br>\n<img src=\"../media/00011/ScreenShot%202020-09-13%2022.17.16.png\" alt=\"ScreenShot 2020-09-13 22.17.16.png\"></p>\n<p>以上で、AzureADB2CのユーザーフローにGoogleログインを追加することができました。</p>","fields":{"slug":"/posts/00011","tagSlugs":["/tag/プログラミング学習/","/tag/プログラミング初心者/"]},"frontmatter":{"date":"2020-09-14","description":"本記事では、Azure AD B2Cのユーザーフローを使い、Googleアカウントでの認証処理を開発していきます。","tags":["プログラミング学習","プログラミング初心者"],"title":"【Azure AD B2C】ユーザーフローにGoogleログインを追加する","socialImage":null}}},"pageContext":{"slug":"/posts/00011"}},"staticQueryHashes":["251939775","3159585216","3942705351","401334301"]}